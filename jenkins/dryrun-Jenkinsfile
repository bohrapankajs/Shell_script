pipeline {
     agent any 
    
    environment {
        SSH_CRED = credentials('SSH_CRED')
        IAM_Cred = credentials('IAM-Cred')
    }
    stages {
        stage('Performing LinkCheck') {
            steps {
                sh "env"
                sh "echo This should only be run against Feature branch only"
                sh "echo Linkcheck completed"
            }
        }
        stage('Performing Ansible DryRun') {
            steps {
                sh "echo This should be only run from PR banch"
                sh "ansible-playbook robot-dryrun.yml -e ansible_user=$(SSH_CRED_USER) -e ansible_password=$(SSH_CRED_PSW) -e COMPONENT=mongodb -e ENV=dev -e aws_access_key=$(IAM_Cred_USER) -e aws_secret_key=$(IAM_Cred_PSW)"
                
            }
        }
        stage('Performing Merge') {
            steps {
                sh "echo This should be only run from Main branch banch"
                sh "echo Performing Merge"
                sh "echo merge completed completed"
            }
        }
    }   
} 
